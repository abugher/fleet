---
- hosts:                neuron-mail
  name:                 'configure tor on neuron-mail'
  gather_facts:         False
  remote_user:          ansible
  become:               yes
  become_method:        sudo
  tasks:

  - name:               'torrc'
    copy:
      owner:            'root'
      group:            'root'
      mode:             '0644'
      src:              '~/code/fleet/conf/tor/neuron-mail/torrc'
      dest:             '/etc/tor/torrc'
    register:           tor_config_neuron_mail
  - name:               'front_page.html'
    copy:
      owner:            'root'
      group:            'root'
      mode:             '0644'
      src:              '~/code/fleet/conf/tor/neuron-mail/front_page.html'
      dest:             '/etc/tor/front_page.html'
  - name:               'service restart'
    service:
      name:             'tor'
      state:            'restarted'
    when:               tor_config_neuron_mail.changed

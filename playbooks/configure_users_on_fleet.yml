---
- hosts:                fleet
  name:                 'configure users on fleet'
  gather_facts:         False
  remote_user:          ansible
  become:               yes
  become_method:        sudo
  tasks:

  - name:               'nagios'
    user:
      name:             'nagios'
      group:            'nagios'
      comment:          'Nagios'
      state:            'present'
      shell:            '/bin/bash'
      system:           'yes'
  - name:               'nagios:  authorize keys'
    authorized_key:
      user:             'nagios'
      key:              "{{ item }}"
    with_file:
      - "~/code/fleet/conf/ssh_keys/nagios@synapse.id_rsa.pub"
  - name:               'nagios:  dotfiles'
    copy:
      src:              '~/code/fleet/conf/dotfiles/universal/'
      dest:             '~nagios/'


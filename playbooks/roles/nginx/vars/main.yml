---
install_packages:
  - 'nginx'
  - 'nginx-extras'
  - 'fcgiwrap'
  - 'php5-fpm'
install_files:
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/conf/nginx/synapse/nginx.conf'
    dest:               '/etc/nginx/nginx.conf'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/conf/nginx/synapse/default'
    dest:               '/etc/nginx/sites-available/default'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/conf/nginx/synapse/default.ssl'
    dest:               '/etc/nginx/sites-available/default.ssl'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/conf/nginx/synapse/smokeping'
    dest:               '/etc/nginx/sites-available/smokeping'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/conf/nginx/synapse/nagios'
    dest:               '/etc/nginx/sites-available/nagios'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/conf/nginx/synapse/nagios.ssl'
    dest:               '/etc/nginx/sites-available/nagios.ssl'
  - owner:              'root'
    group:              'www-data'
    mode:               '0640'
    src:                '~/code/sensitive/conf/ssl/synapse/key.pem'
    dest:               '/etc/nginx/synapse.key'
  - owner:              'root'
    group:              'www-data'
    mode:               '0640'
    src:                '~/code/fleet/conf/ssl/synapse/chain.pem'
    dest:               '/etc/nginx/synapse.crt'
symlinks:
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '/etc/nginx/sites-available/default'
    dest:               '/etc/nginx/sites-enabled/default'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '/etc/nginx/sites-available/default.ssl'
    dest:               '/etc/nginx/sites-enabled/default.ssl'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '/etc/nginx/sites-available/smokeping'
    dest:               '/etc/nginx/sites-enabled/smokeping'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '/etc/nginx/sites-available/nagios'
    dest:               '/etc/nginx/sites-enabled/nagios'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '/etc/nginx/sites-available/nagios.ssl'
    dest:               '/etc/nginx/sites-enabled/nagios.ssl'
enable_services:
  - 'nginx'
restart_services:
  - 'nginx'

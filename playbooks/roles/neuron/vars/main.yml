---
users:
  - 'rachel-phone'
  - 'aaron-phone'
system_users:
  - 'escrow'
  - 'cryptkeeper'
groups:
  - 'rachel-phone'
  - 'aaron-phone'
system_groups:
  - 'escrow'
  - 'cryptkeeper'
create_files:
  - path:               '/usr/share/nginx/www/private'
    owner:              'root'
    group:              'www-data'
    mode:               '0750'
    state:              'directory'
  - path:               '/usr/share/nginx/www/plaintext'
    owner:              'root'
    group:              'root'
    mode:               '0755'
    state:              'directory'
install_files:
  - owner:              'root'
    group:              'root'
    mode:               '0600'
    src:                "~/code/fleet/conf/ssh_keys/root@{{ inventory_hostname }}.known_hosts"
    dest:               '/root/.ssh/known_hosts'
  - owner:              'root'
    group:              'www-data'
    mode:               '0640'
    src:                '~/code/sensitive/conf/nginx/neuron/htpasswd'
    dest:               '/etc/nginx/htpasswd'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "~/code/fleet/conf/nginx/{{ inventory_hostname }}/wiki"
    dest:               "/etc/nginx/sites-available/wiki"
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "~/code/fleet/conf/nginx/{{ inventory_hostname }}/wiki.ssl"
    dest:               "/etc/nginx/sites-available/wiki.ssl"  
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "~/code/fleet/conf/nginx/{{ inventory_hostname }}/transmission"
    dest:               "/etc/nginx/sites-available/transmission"
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "~/code/fleet/conf/nginx/{{ inventory_hostname }}/transmission.ssl"
    dest:               "/etc/nginx/sites-available/transmission.ssl"  
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "~/code/fleet/conf/nginx/{{ inventory_hostname }}/remote"
    dest:               "/etc/nginx/sites-available/remote"
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "~/code/fleet/conf/nginx/{{ inventory_hostname }}/remote.ssl"
    dest:               "/etc/nginx/sites-available/remote.ssl"
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/conf/nginx/neuron/preseed.cfg'
    dest:               '/usr/share/nginx/www/plaintext/preseed.cfg'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/conf/nginx/neuron/index.html'
    dest:               '/usr/share/nginx/www/index.html'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/conf/fstab/neuron/fstab'
    dest:               '/etc/fstab'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '~/code/fleet/cron.d/neuron/chown_pictures'
    dest:               '/etc/cron.d/chown_pictures'
restart_services:
  - 'nginx'
dot_users:
  - 'pi'
symlinks:
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                '/storage/aaron-phone/live/legacy/DCIM/Camera'
    dest:               '/usr/share/nginx/www/private/pictures'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "/etc/nginx/sites-available/wiki"
    dest:               "/etc/nginx/sites-enabled/wiki"
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "/etc/nginx/sites-available/wiki.ssl"
    dest:               "/etc/nginx/sites-enabled/wiki.ssl"
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "/etc/nginx/sites-available/transmission"
    dest:               "/etc/nginx/sites-enabled/transmission"
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "/etc/nginx/sites-available/transmission.ssl"
    dest:               "/etc/nginx/sites-enabled/transmission.ssl"
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "/etc/nginx/sites-available/remote"
    dest:               "/etc/nginx/sites-enabled/remote"
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "/etc/nginx/sites-available/remote.ssl"
    dest:               "/etc/nginx/sites-enabled/remote.ssl"
authorized_keys:
  - user:               'rachel-phone'
    keyfile:            '~/code/fleet/conf/ssh_keys/rsync_backup@rachel-phone.dss_key.pub'
  - user:               'aaron-phone'
    keyfile:            '~/code/fleet/conf/ssh_keys/aaron-phone@aaron-phone.id_rsa.pub'
  - user:               'aaron-phone'
    keyfile:            '~/code/fleet/conf/ssh_keys/rsync_backup@aaron-phone.dss_key.pub'


---
install_packages:
  - 'apache2'
  - 'libapache2-mod-perl2'
  - 'liburi-encode-perl'
enable_apache_modules:
  - 'cgid'
install_files:
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    src:                "{{ role_path }}/files/cgi-bin/list.pl"
    dest:               '/usr/lib/cgi-bin/list.pl'
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    src:                "{{ role_path }}/files/cgi-bin/listing.pl"
    dest:               '/usr/lib/cgi-bin/listing.pl'
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    src:                "{{ role_path }}/files/cgi-bin/remote.pl"
    dest:               '/usr/lib/cgi-bin/remote.pl'
  - owner:              'root'
    group:              'root'
    mode:               '0744'
    src:                "{{ role_path }}/files/www/style.css"
    dest:               '/var/www/html/style.css'
  - owner:              'root'
    group:              'root'
    mode:               '0744'
    src:                "{{ role_path }}/files/www/index.html"
    dest:               '/var/www/html/index.html'
  - owner:              'root'
    group:              'root'
    mode:               '0744'
    src:                "{{ role_path }}/files/www/select-user.html"
    dest:               '/var/www/html/select-user.html'
sync_dirs:
  - src:                "{{ role_path }}/files/parts/"
    dest:               '/var/www/html/parts/'
    delete:             'yes'
  - src:                "{{ role_path }}/files/cgi-bin/mplayer/"
    dest:               '/usr/lib/cgi-bin/mplayer/'
    delete:             'no'
  - src:                "{{ role_path }}/files/cgi-bin/pianobar/"
    dest:               '/usr/lib/cgi-bin/pianobar/'
    delete:             'no'
restart_services:
  - 'apache2'
known_hosts:
  - 'files'
